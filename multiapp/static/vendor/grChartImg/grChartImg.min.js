var grChartImg={'supportNativeCanvas':function(){var objCanv=document.createElement('canvas');var bExist=!!objCanv.getContext;objCanv=null;return bExist;},'supportFlashCanvas':function(){return(typeof(FlashCanvas)!='undefined');},'GetCanvasType':function(){return(this.supportNativeCanvas()==true)?'native':(this.supportFlashCanvas()==true)?'flash':'other';},'GetChartVectorCode':function(strChartID){switch(this.GetCanvasType()){case'native':var nVectGraphs=(document.getElementById(strChartID).getElementsByTagName("SVG").length||document.getElementById(strChartID).getElementsByTagName("svg").length);var strChartsHTML=" ";var obj=document.getElementById(strChartID).getElementsByTagName("svg");strChartsHTML=(obj[0].outerHTML)?obj[0].outerHTML:obj[0].parentNode.innerHTML.substring(obj[0].parentNode.innerHTML.indexOf("<svg"),obj[0].parentNode.innerHTML.indexOf("/svg>")+5);break;default:var strChartsHTML="";alert('This operation not supported\nby this version of grChartImg library.');}
return strChartsHTML;},'GetImageData':function(strChartID){try{switch(this.GetCanvasType()){case'native':var c=document.createElement("CANVAS");canvg(c,this.GetChartVectorCode(strChartID));var imgData=c.toDataURL("image/png");c=null;break;default:alert('This operation not supported\nby this version of grChartImg library.');return false;}}
catch(e){return false;}
return imgData;},'DownloadImage':function(strChartID){try{var imgData=this.GetImageData(strChartID).replace("image/png","image/octet-stream");window.open(imgData);}
catch(e){return false;}},'DownloadImageDataAsImage':function(imgData){imgData=imgData.replace("image/png","image/octet-stream");window.open(imgData);},'CopyImageToClip':function(strChartID){if(navigator.userAgent.indexOf("MSIE")!=-1){var imgData=this.GetImageData(strChartID);if(imgData==false){return;}
var oImg=document.createElement("IMG");var oCol=document.body.createControlRange();oImg.src=imgData;document.body.appendChild(oImg);oCol.addElement(oImg);document.body.removeChild(oImg);var retValue=oCol.execCommand("copy",false,null);oImg=null;oCol=null;if(retValue==false){alert("Clipboard:Access Denied")};}},'CopyImageDataToClip':function(imgData){if(navigator.userAgent.indexOf("MSIE")!=-1){var oImg=document.createElement("IMG");var oCol=document.body.createControlRange();oImg.src=imgData;document.body.appendChild(oImg);oCol.addElement(oImg);document.body.removeChild(oImg);var retValue=oCol.execCommand("copy",false,null);oImg=null;oCol=null;if(retValue==false){alert("Clipboard:Access Denied")};}},'ShowImage':function(strChartID,bDialog){if(bDialog==true){var BrowserDimensions=GetDimensionsBrowser();var ChartWidth=parseInt(document.getElementById(strChartID).style.width);var ChartHeight=parseInt(document.getElementById(strChartID).style.height);strFeatures="left="+(Math.round((BrowserDimensions.Width-ChartWidth)/2)+BrowserDimensions.Left)+",top="+(Math.round((BrowserDimensions.Height-ChartHeight)/2)+BrowserDimensions.Top)+",height="+ChartHeight+",width="+ChartWidth;}
else{strFeatures=""}
var imgData=this.GetImageData(strChartID);if(imgData==false){return;}
if(navigator.userAgent.indexOf("MSIE")==-1){window.open(imgData,"",strFeatures);}
else{var oWin=window.open("","_blank",strFeatures);strHTML="<html><head><title>Chart Image</title></head><body style='margin:0'><img src=\'"+imgData+"\'></body></html>";oWin.document.write(strHTML);oWin.document.close();}},'ShowImageDataAsImage':function(imgData,jsonOptions){if(jsonOptions.bDialog==true){var BrowserDimensions=GetDimensionsBrowser();var ChartWidth=parseInt(jsonOptions.width);var ChartHeight=parseInt(jsonOptions.height);strFeatures="left="+(Math.round((BrowserDimensions.Width-ChartWidth)/2)+BrowserDimensions.Left)+",top="+(Math.round((BrowserDimensions.Height-ChartHeight)/2)+BrowserDimensions.Top)+",height="+ChartHeight+",width="+ChartWidth;}
else{strFeatures=""}
if(navigator.userAgent.indexOf("MSIE")==-1){window.open(imgData,"",strFeatures);}
else{var oWin=window.open("","_blank",strFeatures);strHTML="<html><head><title>Chart Image</title></head><body style='margin:0'><img src=\'"+imgData+"\'></body></html>";oWin.document.write(strHTML);oWin.document.close();}},'VectorGraphtoImageData':function(strVectorCode,jsonOptions){try{switch(this.GetCanvasType()){case'native':var c=document.createElement("CANVAS");if(strVectorCode.indexOf("<svg")!=-1){canvg(c,strVectorCode);var imgData=c.toDataURL("image/png");}
c=null;break;default:return false;}}
catch(e){return false;}
return imgData;}};function GetDimensionsBrowser(){var l=(typeof window.screenLeft!='undefined')?window.screenLeft:window.screenX;var t=(typeof window.screenTop!='undefined')?window.screenTop:window.screenY;var w=(typeof window.outerWidth!='undefined')?window.outerWidth:document.documentElement.offsetWidth;var h=(typeof window.outerHeight!='undefined')?window.outerHeight:document.documentElement.offsetHeight;return{'Left':l,'Top':t,'Height':h,'Width':w};}